(this.webpackJsonpsortrees=this.webpackJsonpsortrees||[]).push([[0],{19:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var i=n(5),r=n(15),c=n(21),a=n(0),l=n.n(a),o=n(9),d=(n(19),n(18)),s=n(37),u=n(38),f={file:{id:"file",iconStyle:"file",iconURL:"./icons/html.png"},folder:{id:"folder",iconStyle:"folder",iconURL:"./icons/folder.png"}},g=n(2),b={},h=window.getComputedStyle(document.documentElement)["font-size"].replace("px",""),v=function(e){var t=e.idx,n=e.id,r=e.card,c=e.text,l=e.index,o=e.parent,v=(e.timestamp,e.fileType),p=e.API,j=e.config,x=e.expanded,m=e.sons;console.log("rendered : "+c+" idx: "+t+" remSize: "+h+" config : "+JSON.stringify(j));var O=Object(a.useState)(Date.now()),y=Object(i.a)(O,2),T=(y[0],y[1]),k=Object(a.useState)(0),S=Object(i.a)(k,2),C=S[0],N=S[1],D=function(e,n){E&&I.current&&p.tryToSwapNodes(e.idx,t,C)},I=Object(a.useRef)(null),B=(Object(a.useRef)(null),Object(s.a)({accept:f.file.id,collect:function(e){return{handlerId:e.getHandlerId(),isOver:e.isOver(),isOverCurrent:e.isOver({shallow:!0})}},drop:function(e,t){console.log("drop called"),"drop"===j.mode&&D(e)},hover:function(e,n){var i;if(I.current&&e.idx!==t){var r=null===(i=I.current)||void 0===i?void 0:i.getBoundingClientRect(),c=r.bottom-r.top,a=(r.left-r.right)/2,l=c/2,o=n.getClientOffset(),d=o.x-r.left,s=o.y-r.top,u=(s>l?2:0)+(d<a?1:2);s>h*j.gutterTop&&s<c-h*j.gutterBottom&&(u=5),"file"===j.treeType&&v!=f.folder.id&&5===u||(u!==C&&N(u),"hover"===j.mode&&D(e))}}})),w=Object(i.a)(B,2),A=w[0],R=A.handlerId,E=(A.isOver,A.isOverCurrent),L=w[1],F=Object(u.a)({type:f.file.id,item:function(){return{id:n,index:l,parent:o,setUpdate:T,idx:t}},collect:function(e){return{isDragging:e.isDragging()}}}),J=Object(i.a)(F,2),M=J[0].isDragging,P=J[1],U=M?0:1;!function(){if(!E||"hover"==j.mode);}();P(L(I)),b.paddingLeft=j.gutterLeft+"rem",b.paddingTop=j.gutterTop+"rem",b.paddingBottom=j.gutterBottom+"rem";var z=function(){p.addChildren(t)},q=function(){p.deleteNode(t)},H=function(){m<=0||p.toggleVisibility(t)},V=function(){return{transform:x?"rotate(90deg)":"rotate(0deg)",transition:"transform 150ms ease"}};return Object(g.jsx)("div",{className:"card-container",children:Object(g.jsxs)("div",{className:"card"+(E&&5===C?" hover-drop":""),ref:I,style:Object(d.a)(Object(d.a)({},b),{},{opacity:U}),"data-handler-id":R,children:[function(){if(!E||1!==C&&2!==C)return"";var e={position:"absolute",height:h*j.gutterTop+"px",width:"100%",backgroundColor:"#6097CE",marginTop:"-"+j.gutterTop+"rem",marginLeft:"-"+j.gutterLeft+"rem"};return Object(g.jsx)("div",{style:e})}(),Object(g.jsxs)("div",{className:"inner",children:[m<=0?Object(g.jsx)("p",{style:V(),className:"handle",children:Object(g.jsx)("span",{children:"\xa0"})}):Object(g.jsx)("p",{style:V(),className:"handle",onClick:H,children:Object(g.jsx)("span",{children:">"})}),Object(g.jsx)("img",{className:"icon "+f[v].iconStyle,src:function(){var e;return null!==(e=r.icon)&&void 0!==e?e:f[v].iconURL}()}),Object(g.jsx)("p",{className:"text",children:c}),Object(g.jsx)("br",{}),"file"!==j.treeType||"file"===j.treeType&&v===f.folder.id?Object(g.jsx)("button",{onClick:z,className:"button add",children:"+ Add child"}):"",Object(g.jsx)(g.Fragment,{children:Object(g.jsx)("button",{onClick:q,className:"button remove",children:"x Remove element"})})]}),function(){if(!E||3!==C&&4!==C)return"";var e={position:"absolute",height:h*j.gutterBottom+"px",width:"100%",backgroundColor:"#6097CE",marginLeft:"-"+j.gutterLeft+"rem"};return Object(g.jsx)("div",{style:e})}()]})})};function p(e,t,n,i,r,c){return Object(g.jsx)(v,{idx:n.getID(e.id),card:e,index:t,id:e.id,text:e.text,children:e.children,API:n,timeStamp:n.getTimeStamp(e.id),fileType:n.getFileType(e.id),config:i,expanded:r,sons:c},e.id)}var j=function(e){e.idx,e.id;var t=e.card,n=(e.text,e.index),i=(e.moveCard,e.children),r=(e.parent,e.expanded),c=(e.timestamp,e.API),a=e.config;return Object(g.jsxs)("div",{className:"leaf",children:[Object(g.jsx)("div",{children:p(t,n,c,a,r,i.length)}),i&&r?Object(g.jsx)("div",{children:i.map((function(e,t){return O(e,t,c,a)}))}):null]})},x=function(e,t){return e.card===t.card},m=l.a.memo(j,x),O=function(e,t,n,i){return Object(g.jsx)(m,{idx:n.getID(e.id),card:e,index:t,id:e.id,text:e.text,children:e.children,API:n,expanded:n.getFastData(e.id).visible,timeStamp:n.getTimeStamp(e.id),config:i},e.id)},y={},T=function(e){var t,n,i,r,c,a,l=e.tree,o=e.name,d=e.options,s=e.callback,u={mode:null!==(t=d.mode)&&void 0!==t?t:"hover",gutterTop:null!==(n=d.gutterTop)&&void 0!==n?n:.5,gutterBottom:null!==(i=d.gutterBottom)&&void 0!==i?i:.5,gutterLeft:null!==(r=d.gutterLeft)&&void 0!==r?r:1,quadrantSize:null!==(c=d.quadrantSize)&&void 0!==c?c:1,treeType:null!==(a=d.treeType)&&void 0!==a?a:"file"},b=function e(t,n,i){for(var r=0;r<t.children.length;r++){var c,a,l=t.children[r],d=o+l.id;if(n.fast[d]={lastUpdate:0,visible:null===(c=l.visible)||void 0===c||c,parent:i,index:r},"file"===u.treeType)n.fast[d].fileType=null!==(a=l.fileType)&&void 0!==a?a:f.folder.id;e(l,n,d)}},h={treename:o,fast:{},lastID:8};return function(e){e.tree=l,b(l,e,"")}(h),Object(g.jsx)(k,{data:h,config:u,callback:s})},k=function(e){var t=e.data,n=e.config,r=e.callback,l=Object(a.useState)(t),d=Object(i.a)(l,2),s=d[0],u=d[1],b=Object(a.useRef)(s);r&&(r.current.getData=function(){return b.current.tree}),function(){return s.tree};var h=function(e){b.current=e,u(e)},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.current;return t.treename+e},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.current;return t.fast[e].index},j=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.current,n=[t.fast[e].index],i=t.fast[e];""!==i.parent;)i=t.fast[i.parent],n.push(i.index);return n},x=function(e,t,n){for(var i=e.tree,r=n.length-1;r>-1+t;r--)i=i.children[n[r]];return i},m=function e(t,n){var i=n.id;delete t.fast[v(i)];var r,a=Object(c.a)(n.children);try{for(a.s();!(r=a.n()).done;){e(t,r.value)}}catch(l){a.e(l)}finally{a.f()}},T=function(e,t,n,i){Math.max(n,0);for(var r=n;r<t.children.length;r++)e.fast[v(t.children[r].id)].index+=i},k=function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&m(e,t.children[n]),t.children.splice(n,1),T(e,t,n,-1)},S=function(e,t,n,i){t.children.splice(i,0,n),T(e,t,i+1,1),e.fast[v(n.id,e)].index=i,e.fast[v(n.id,e)].parent=t.isRoot?"":v(t.id,e)},C=Object(a.useCallback)((function(e){var t=j(e),n=Object(o.a)(b.current,(function(n){var i=x(n,1,t),r=p(e,n);k(n,i,r,!0)}));h(n)}),[]),N=Object(a.useCallback)((function(e,t,n){var i=j(e),r=j(t),c=Object(o.a)(b.current,(function(c){var a=x(c,1,i),l=x(c,5!=n?1:0,r),o=p(e,c),d=a.children[o],s=p(t);switch(k(c,a,o,!1),n){case 0:S(c,l,d,s);break;case 1:S(c,l,d,s+1);break;case 5:!function(e,t,n){var i=t.children.length;t.children.push(n),e.fast[v(n.id,e)].index=i,e.fast[v(n.id,e)].parent=t.isRoot?"":v(t.id,e)}(c,l,d)}}));h(c)})),D=Object(a.useCallback)((function(e,t,n){var i=function(e,t){for(var n={isSibling:!1,isAncestor:!1,isSon:!1,isBefore:!1,isExactlyBefore:!1,isExactlyAfter:!1},i=e.length,r=t.length,c=Math.min(i,r),a=0,l=0;l<c&&e[i-l-1]==t[r-l-1];l++)a++;if(a===c){var o=[c===i,c===r];n.isAncestor=o[0],n.isSon=o[1]}if(r===i&&a===c-1){var d=e[0]-t[0],s=[!0,d<0,-1===d,1===d];n.isSibling=s[0],n.isBefore=s[1],n.isExactlyBefore=s[2],n.isExactlyAfter=s[3]}return n}(j(e),j(t));if(!i.isAncestor)switch(n){case 0:break;case 1:case 2:i.isBefore?!i.isExactlyBefore&&N(e,t,0):N(e,t,0);break;case 3:case 4:if(i.isExactlyAfter)break;i.isExactlyBefore?N(e,t,0):N(e,t,1);break;case 5:N(e,t,5)}})),I=Object(a.useCallback)((function(e){var t=j(e),i=Object(o.a)(b.current,(function(i){i.lastID++;var r=x(i,0,t);i.fast[i.treename+i.lastID]={visible:!0,parent:e,index:r.children.length},"file"===n.treeType&&(i.fast[i.treename+i.lastID].fileType=f.folder.id);var c={name:"new folder"+i.lastID,text:"new folder "+i.lastID,id:i.lastID,children:[]};r.children.push(c)}));h(i)}),[]),B=Object(a.useCallback)((function(e){var t=j(e),n=Object(o.a)(b.current,(function(n){var i=x(n,0,t);console.log(JSON.stringify(n.fast)),console.log("THE ID: "+v(e,n)),n.fast[e].visible=!n.fast[e].visible;var r=v(e,n)+"xxxr";i[r]=0,delete i[r]}));h(n)}),[]),w={getID:v,getFastData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.current;return t.fast[v(e)]},getTimeStamp:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.current;return t.fast[v(e)].lastUpdate},addChildren:I,deleteNode:C,tryToSwapNodes:D,toggleVisibility:B,getFileType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.current;return t.fast[v(e)].fileType}};return Object(g.jsx)(g.Fragment,{children:Object(g.jsx)("div",{className:"treeview",style:y,children:s.tree.children.map((function(e,t){return O(e,t,w,n)}))})})},S=n(36),C=n(23),N={isRoot:!0,children:[{text:"My documents",id:1,children:[{text:"My videos",id:4,children:[],fileType:"file"},{text:"My pictures",id:5,children:[]}]},{text:"child 2",id:2,children:[]},{text:"child 3",id:3,children:[]},{text:"child 0",id:0,children:[]},{text:"child -1",id:-1,children:[]}]};function D(){var e=Object(a.useRef)({});return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(S.a,{backend:C.a,children:Object(g.jsx)(T,{tree:N,name:"testTree",options:{mode:"drop",gutterTop:1,gutterBottom:1},callback:e})}),Object(g.jsx)("div",{children:Object(g.jsx)(I,{callback:e})})]})}console.log("FROM APP : "+JSON.stringify(N));var I=function(e){var t=e.callback,n=Object(a.useState)(""),r=Object(i.a)(n,2),c=r[0],l=r[1];return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("button",{onClick:function(){console.log("callback test "+JSON.stringify(t.current.getData())),l(JSON.stringify(t.current.getData(),void 0,4))},children:"Get the tree"}),Object(g.jsx)("textarea",{value:c})]})},B=document.getElementById("root");Object(r.render)(Object(g.jsx)(D,{}),B)}},[[31,1,2]]]);
//# sourceMappingURL=main.cda2cb48.chunk.js.map