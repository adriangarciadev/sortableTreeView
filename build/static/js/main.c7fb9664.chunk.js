(this.webpackJsonpsortrees=this.webpackJsonpsortrees||[]).push([[0],{19:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var i=n(5),r=n(15),c=n(21),a=n(0),l=n.n(a),d=n(9),o=(n(19),n(18)),s=n(37),u=n(38),f={file:{id:"file",iconStyle:"file",iconURL:"./build/icons/html.png"},folder:{id:"folder",iconStyle:"folder",iconURL:"./build/icons/folder.png"}},b=n(2),h={},g=window.getComputedStyle(document.documentElement)["font-size"].replace("px",""),v=function(e){var t=e.idx,n=e.id,r=e.card,c=e.text,l=e.index,d=e.parent,v=(e.timestamp,e.fileType),j=e.API,p=e.config,x=e.expanded,m=e.sons,O=Object(a.useState)(Date.now()),y=Object(i.a)(O,2),T=(y[0],y[1]),k=Object(a.useState)(0),S=Object(i.a)(k,2),C=S[0],D=S[1],N=function(e,n){E&&I.current&&j.tryToSwapNodes(e.idx,t,C)},I=Object(a.useRef)(null),B=(Object(a.useRef)(null),Object(s.a)({accept:f.file.id,collect:function(e){return{handlerId:e.getHandlerId(),isOver:e.isOver(),isOverCurrent:e.isOver({shallow:!0})}},drop:function(e,t){"drop"===p.mode&&N(e)},hover:function(e,n){var i;if(I.current&&e.idx!==t){var r=null===(i=I.current)||void 0===i?void 0:i.getBoundingClientRect(),c=r.bottom-r.top,a=(r.left-r.right)/2,l=c/2,d=n.getClientOffset(),o=d.x-r.left,s=d.y-r.top,u=(s>l?2:0)+(o<a?1:2);s>g*p.gutterTop&&s<c-g*p.gutterBottom&&(u=5),"file"===p.treeType&&v!=f.folder.id&&5===u||(u!==C&&D(u),"hover"===p.mode&&N(e))}}})),w=Object(i.a)(B,2),A=w[0],R=A.handlerId,E=(A.isOver,A.isOverCurrent),L=w[1],F=Object(u.a)({type:f.file.id,item:function(){return{id:n,index:l,parent:d,setUpdate:T,idx:t}},collect:function(e){return{isDragging:e.isDragging()}}}),J=Object(i.a)(F,2),M=J[0].isDragging?0:1;(0,J[1])(L(I)),h.paddingLeft=p.gutterLeft+"rem",h.paddingTop=p.gutterTop+"rem",h.paddingBottom=p.gutterBottom+"rem";var P=function(){j.addChildren(t)},U=function(){j.deleteNode(t)},z=function(){m<=0||j.toggleVisibility(t)},q=function(){return{transform:x?"rotate(90deg)":"rotate(0deg)",transition:"transform 150ms ease"}};return Object(b.jsx)("div",{className:"card-container",children:Object(b.jsxs)("div",{className:"card"+(E&&5===C?" hover-drop":""),ref:I,style:Object(o.a)(Object(o.a)({},h),{},{opacity:M}),"data-handler-id":R,children:[function(){if(!E||1!==C&&2!==C)return"";var e={position:"absolute",height:g*p.gutterTop+"px",width:"100%",backgroundColor:"#6097CE",marginTop:"-"+p.gutterTop+"rem",marginLeft:"-"+p.gutterLeft+"rem"};return Object(b.jsx)("div",{style:e})}(),Object(b.jsxs)("div",{className:"inner",children:[m<=0?Object(b.jsx)("p",{style:q(),className:"handle",children:Object(b.jsx)("span",{children:"\xa0"})}):Object(b.jsx)("p",{style:q(),className:"handle",onClick:z,children:Object(b.jsx)("span",{children:">"})}),Object(b.jsx)("img",{className:"icon "+f[v].iconStyle,src:function(){var e;return null!==(e=r.icon)&&void 0!==e?e:f[v].iconURL}()}),Object(b.jsx)("p",{className:"text",children:c}),Object(b.jsx)("br",{}),"file"!==p.treeType||"file"===p.treeType&&v===f.folder.id?Object(b.jsx)("button",{onClick:P,className:"button add",children:"+ Add child"}):"",Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("button",{onClick:U,className:"button remove",children:"x Remove element"})})]}),function(){if(!E||3!==C&&4!==C)return"";var e={position:"absolute",height:g*p.gutterBottom+"px",width:"100%",backgroundColor:"#6097CE",marginLeft:"-"+p.gutterLeft+"rem"};return Object(b.jsx)("div",{style:e})}()]})})};function j(e,t,n,i,r,c){return Object(b.jsx)(v,{idx:n.getID(e.id),card:e,index:t,id:e.id,text:e.text,children:e.children,API:n,timeStamp:n.getTimeStamp(e.id),fileType:n.getFileType(e.id),config:i,expanded:r,sons:c},e.id)}var p=function(e){e.idx,e.id;var t=e.card,n=(e.text,e.index),i=(e.moveCard,e.children),r=(e.parent,e.expanded),c=(e.timestamp,e.API),a=e.config;return Object(b.jsxs)("div",{className:"leaf",children:[Object(b.jsx)("div",{children:j(t,n,c,a,r,i.length)}),i&&r?Object(b.jsx)("div",{children:i.map((function(e,t){return O(e,t,c,a)}))}):null]})},x=function(e,t){return e.card===t.card},m=l.a.memo(p,x),O=function(e,t,n,i){return Object(b.jsx)(m,{idx:n.getID(e.id),card:e,index:t,id:e.id,text:e.text,children:e.children,API:n,expanded:n.getFastData(e.id).visible,timeStamp:n.getTimeStamp(e.id),config:i},e.id)},y={},T=function(e){var t,n,i,r,c,a,l=e.tree,d=e.name,o=e.options,s=e.callback,u={mode:null!==(t=o.mode)&&void 0!==t?t:"hover",gutterTop:null!==(n=o.gutterTop)&&void 0!==n?n:.5,gutterBottom:null!==(i=o.gutterBottom)&&void 0!==i?i:.5,gutterLeft:null!==(r=o.gutterLeft)&&void 0!==r?r:1,quadrantSize:null!==(c=o.quadrantSize)&&void 0!==c?c:1,treeType:null!==(a=o.treeType)&&void 0!==a?a:"file"},h=function e(t,n,i){for(var r=0;r<t.children.length;r++){var c,a,l=t.children[r],o=d+l.id;if(n.fast[o]={lastUpdate:0,visible:null===(c=l.visible)||void 0===c||c,parent:i,index:r},"file"===u.treeType)n.fast[o].fileType=null!==(a=l.fileType)&&void 0!==a?a:f.folder.id;e(l,n,o)}},g={treename:d,fast:{},lastID:8};return function(e){e.tree=l,h(l,e,"")}(g),Object(b.jsx)(k,{data:g,config:u,callback:s})},k=function(e){var t=e.data,n=e.config,r=e.callback,l=Object(a.useState)(t),o=Object(i.a)(l,2),s=o[0],u=o[1],h=Object(a.useRef)(s);r&&(r.current.getData=function(){return h.current.tree}),function(){return s.tree};var g=function(e){h.current=e,u(e)},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.current;return t.treename+e},j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.current;return t.fast[e].index},p=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.current,n=[t.fast[e].index],i=t.fast[e];""!==i.parent;)i=t.fast[i.parent],n.push(i.index);return n},x=function(e,t,n){for(var i=e.tree,r=n.length-1;r>-1+t;r--)i=i.children[n[r]];return i},m=function e(t,n){var i=n.id;delete t.fast[v(i)];var r,a=Object(c.a)(n.children);try{for(a.s();!(r=a.n()).done;){e(t,r.value)}}catch(l){a.e(l)}finally{a.f()}},T=function(e,t,n,i){Math.max(n,0);for(var r=n;r<t.children.length;r++)e.fast[v(t.children[r].id)].index+=i},k=function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&m(e,t.children[n]),t.children.splice(n,1),T(e,t,n,-1)},S=function(e,t,n,i){t.children.splice(i,0,n),T(e,t,i+1,1),e.fast[v(n.id,e)].index=i,e.fast[v(n.id,e)].parent=t.isRoot?"":v(t.id,e)},C=Object(a.useCallback)((function(e){var t=p(e),n=Object(d.a)(h.current,(function(n){var i=x(n,1,t),r=j(e,n);k(n,i,r,!0)}));g(n)}),[]),D=Object(a.useCallback)((function(e,t,n){var i=p(e),r=p(t),c=Object(d.a)(h.current,(function(c){var a=x(c,1,i),l=x(c,5!=n?1:0,r),d=j(e,c),o=a.children[d],s=j(t);switch(k(c,a,d,!1),n){case 0:S(c,l,o,s);break;case 1:S(c,l,o,s+1);break;case 5:!function(e,t,n){var i=t.children.length;t.children.push(n),e.fast[v(n.id,e)].index=i,e.fast[v(n.id,e)].parent=t.isRoot?"":v(t.id,e)}(c,l,o)}}));g(c)})),N=Object(a.useCallback)((function(e,t,n){var i=function(e,t){for(var n={isSibling:!1,isAncestor:!1,isSon:!1,isBefore:!1,isExactlyBefore:!1,isExactlyAfter:!1},i=e.length,r=t.length,c=Math.min(i,r),a=0,l=0;l<c&&e[i-l-1]==t[r-l-1];l++)a++;if(a===c){var d=[c===i,c===r];n.isAncestor=d[0],n.isSon=d[1]}if(r===i&&a===c-1){var o=e[0]-t[0],s=[!0,o<0,-1===o,1===o];n.isSibling=s[0],n.isBefore=s[1],n.isExactlyBefore=s[2],n.isExactlyAfter=s[3]}return n}(p(e),p(t));if(!i.isAncestor)switch(n){case 0:break;case 1:case 2:i.isBefore?!i.isExactlyBefore&&D(e,t,0):D(e,t,0);break;case 3:case 4:if(i.isExactlyAfter)break;i.isExactlyBefore?D(e,t,0):D(e,t,1);break;case 5:D(e,t,5)}})),I=Object(a.useCallback)((function(e){var t=p(e),i=Object(d.a)(h.current,(function(i){i.lastID++;var r=x(i,0,t);i.fast[i.treename+i.lastID]={visible:!0,parent:e,index:r.children.length},"file"===n.treeType&&(i.fast[i.treename+i.lastID].fileType=f.folder.id);var c={name:"new folder"+i.lastID,text:"new folder "+i.lastID,id:i.lastID,children:[]};r.children.push(c)}));g(i)}),[]),B=Object(a.useCallback)((function(e){var t=p(e),n=Object(d.a)(h.current,(function(n){var i=x(n,0,t);console.log(JSON.stringify(n.fast)),console.log("THE ID: "+v(e,n)),n.fast[e].visible=!n.fast[e].visible;var r=v(e,n)+"xxxr";i[r]=0,delete i[r]}));g(n)}),[]),w={getID:v,getFastData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.current;return t.fast[v(e)]},getTimeStamp:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.current;return t.fast[v(e)].lastUpdate},addChildren:I,deleteNode:C,tryToSwapNodes:N,toggleVisibility:B,getFileType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.current;return t.fast[v(e)].fileType}};return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{className:"treeview",style:y,children:s.tree.children.map((function(e,t){return O(e,t,w,n)}))})})},S=n(36),C=n(23),D={isRoot:!0,children:[{text:"My documents",id:1,children:[{text:"My videos",id:4,children:[],fileType:"file"},{text:"My pictures",id:5,children:[]}]},{text:"child 2",id:2,children:[]},{text:"child 3",id:3,children:[]},{text:"child 0",id:0,children:[]},{text:"child -1",id:-1,children:[]}]};function N(){var e=Object(a.useRef)({});return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(S.a,{backend:C.a,children:Object(b.jsx)(T,{tree:D,name:"testTree",options:{mode:"drop",gutterTop:1,gutterBottom:1},callback:e})}),Object(b.jsx)("div",{children:Object(b.jsx)(I,{callback:e})})]})}console.log("FROM APP : "+JSON.stringify(D));var I=function(e){var t=e.callback,n=Object(a.useState)(""),r=Object(i.a)(n,2),c=r[0],l=r[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){console.log("callback test "+JSON.stringify(t.current.getData())),l(JSON.stringify(t.current.getData(),void 0,4))},children:"Get the tree"}),Object(b.jsx)("textarea",{value:c})]})},B=document.getElementById("root");Object(r.render)(Object(b.jsx)(N,{}),B)}},[[31,1,2]]]);
//# sourceMappingURL=main.c7fb9664.chunk.js.map